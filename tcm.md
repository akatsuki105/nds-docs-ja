# TCM

TCM = `Tightly Coupled Memory` = `密結合メモリ`

バスクロックがARM9のCPUクロックより遅いため、メインメモリへのアクセスはパフォーマンスに制限がかかります。

TCMはARM9のコアに直接入ってるメモリで、CPUクロックと同じ速度(66MHz)で動作します。

キャッシュと違いプログラマが内容をコントロールできるのが特徴で、命令コード用TCM(`ITCM`)とデータ用TCM(`DTCM`)があります。

CPUがTCMにアクセスしている間はシステムバスが空くので、その間にDMAコントローラを動作させることができます。

```
  ITCM 32KB, base=00000000h (固定)
  DTCM 16KB, base=moveable  (デフォルトでは base=27C0000h)
```

ITCMは移動できませんが、NDSのファームウェアではITCMのサイズを32MBに設定しているため、`0x0..1FFFFFF`のITCMミラーが生成されます。

DTCMはCP15の`C9,C1,1`でどこにマッピングするかを設定できます。

さらに、PU(後述)を使ってその領域のメモリをロック/アンロックすることができます。このトリックにより、下位32MBのメモリ内のどこにでもITCMを移動させることができます。
